<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>STOOK - Altri Atenei (Appunti)</title>
<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">
<style>
/* Stesso CSS di GliAltriAtenei.html */
:root{--bg:#ffffff;--text:#000000;--gap:8px;--card-radius:12px;--card-border:#e5e5e5;}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;display:flex;flex-direction:column;align-items:center;}
h1{margin:1rem 0;font-size:clamp(2.5rem,8vw,4rem);font-weight:400;text-transform:uppercase;line-height:1;text-align:center;font-family:'Luckiest Guy', cursive;}
/* profilo, sidebar, search, row, card â†’ identici a prima */
.profile{position:fixed;top:1rem;right:1rem;display:flex;flex-direction:column;align-items:center;font-size:.9rem;}
.profile-pic{width:48px;height:48px;border-radius:50%;background:#ddd;display:flex;align-items:center;justify-content:center;font-weight:700;color:#000;}
.username{margin-top:.25rem;text-decoration:none;color:inherit;font-weight:500;}
.username:hover{text-decoration:underline}
.dropdown{display:none;position:absolute;top:4.5rem;right:1rem;background:#fff;border:1px solid #ccc;border-radius:8px;padding:1rem;min-width:200px;box-shadow:0 2px 6px rgba(0,0,0,.15);}
.dropdown-content h2{margin:0 0 1rem;font-size:1.1rem}
.menu-btn{position:fixed;top:1rem;left:1rem;cursor:pointer;background:transparent;border:none;z-index:1001;display:flex;flex-direction:column;gap:5px;}
.menu-btn span{display:block;width:25px;height:3px;background:#000;border-radius:2px;transition:all 0.3s ease;}
.menu-btn.hidden{display:none;}
.sidebar{position:fixed;top:0;left:-260px;width:250px;height:100%;background:#f5f5f5;box-shadow:2px 0 8px rgba(0,0,0,0.2);padding:1rem;transition:left 0.3s ease;z-index:1000;}
.sidebar.open{left:0;}
.overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.3);z-index:999;}
.overlay.show{display:block;}
.sidebar h2{font-family:'Luckiest Guy', cursive;font-size:1.5rem;margin-bottom:1rem;}
.sidebar a{display:block;margin:.5rem 0;text-decoration:none;color:#000;}
.search-box{margin:1rem auto;width:90%;max-width:400px;}
.search-box input{width:100%;padding:.6rem 1rem;border:1px solid #ccc;border-radius:8px;font-size:1rem;}
.row{display:flex;flex-wrap:wrap;gap:var(--gap);width:100%;padding:0 .5rem;justify-content:center;}
.card{flex:0 0 calc((100% - (var(--gap)*3)) / 4);border:1px solid var(--card-border);border-radius:var(--card-radius);background:#fff;padding:12px;display:flex;justify-content:center;align-items:center;text-align:center;cursor:pointer;transition:transform .15s ease;min-height:100px;}
.card:hover{transform:scale(1.03);}
.card-title{font-weight:600;font-size:.95rem;}
@media (max-width: 1000px){.card{flex:0 0 calc((100% - (var(--gap)*2)) / 2);}}
@media (max-width: 600px){.card{flex:0 0 100%;}}
</style>
</head>
<body>

<button class="menu-btn" id="menuBtn"><span></span><span></span><span></span></button>
<div class="sidebar" id="sidebar">
  <h2>Menu</h2>
  <a href="index.html">Home</a>
  <a href="GliAltriAtenei.html">Libri</a>
  <a href="GliAltriAteneiAppunti.html">Appunti</a>
</div>
<div class="overlay" id="overlay"></div>

<div class="profile"><div class="profile-pic">AB</div><a href="#" class="username" id="openProfile">@andrea92</a></div>
<div class="dropdown" id="profileDropdown"><div class="dropdown-content"><h2><strong>Ciao @andrea92</strong></h2></div></div>

<h1>STOOK</h1>

<div class="search-box"><input type="text" id="searchInput" placeholder="Cerca un ateneo..."></div>
<div class="row" id="atenei-list"></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL="INSERISCI_QUI_PROJECT_URL";
const SUPABASE_ANON_KEY="INSERISCI_QUI_ANON_PUBLIC_KEY";
const client=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);

async function loadAtenei(){
  const {data,error}=await client.from("atenei").select("*").eq("tipo","appunti").order("nome",{ascending:true});
  if(error){console.error(error);return;}
  renderAtenei(data);
}
function renderAtenei(list){
  const container=document.getElementById("atenei-list");
  container.innerHTML="";
  list.forEach(ateneo=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`<div class="card-title">${ateneo.nome}</div>`;
    div.onclick=async ()=>{
      await client.from("atenei").update({clicks:ateneo.clicks+1}).eq("id",ateneo.id);
      alert("Mostro gli appunti di "+ateneo.nome);
    };
    container.appendChild(div);
  });
}
document.getElementById("searchInput").addEventListener("input",async e=>{
  const search=e.target.value.toLowerCase();
  const {data}=await client.from("atenei").select("*").eq("tipo","appunti");
  const filtered=data.filter(a=>a.nome.toLowerCase().includes(search));
  renderAtenei(filtered);
  if(filtered.length===1){
    await client.from("atenei").update({clicks:filtered[0].clicks+1}).eq("id",filtered[0].id);
  }
});
loadAtenei();

/* Dropdown e Sidebar */
const openBtn=document.getElementById("openProfile");
const dropdown=document.getElementById("profileDropdown");
openBtn.addEventListener("click",e=>{e.preventDefault();dropdown.style.display=(dropdown.style.display==="block")?"none":"block";});
window.addEventListener("click",e=>{if(!dropdown.contains(e.target)&&!openBtn.contains(e.target)){dropdown.style.display="none";}});
const menuBtn=document.getElementById("menuBtn");
const sidebar=document.getElementById("sidebar");
const overlay=document.getElementById("overlay");
menuBtn.addEventListener("click",()=>{sidebar.classList.add("open");overlay.classList.add("show");menuBtn.classList.add("hidden");});
overlay.addEventListener("click",()=>{sidebar.classList.remove("open");overlay.classList.remove("show");menuBtn.classList.remove("hidden");});
</script>
</body>
</html>
